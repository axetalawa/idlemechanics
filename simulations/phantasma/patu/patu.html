<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Título Atualizado -->
    <title>Patu [Idle Mechanics]</title> 
    <meta name="description" content="An animated display of six mysterious neon ghost owls, settling into various choreographies with refined particle effects." />
    
    <!-- Fonte (do tema) e Link do Tema CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="idle-mechanics-theme.css">

    <style>
        /* Variáveis CSS - Mantidas as específicas da simulação */
        :root {
            --primary-glyph-color: #FF1E8E; /* Pink (corresponde a --im-color-primary) */
            --solar-yellow: #FFEF00; /* Yellow (corresponde a --im-color-secondary) */
            --deep-purple: #2c015a; /* Roxo Escuro (específico desta simulação) */
            /* CORREÇÃO: Readicionando --light-text localmente para os contornos */
            --light-text: #BBBBBB; 
        }

        /* Estilos Base do Body Removidos (vêm do tema) */
        body {
            overflow: hidden; /* Mantido: Previne scrollbars */
            cursor: crosshair; /* Mantido: Cursor padrão */
        }

        /* Wrapper Principal (inalterado) */
        #main-content-wrapper {
            width: 100%;
            min-height: 100vh; 
        }

        /* --- Estilos da Seção das Corujas Neon (mantidos em grande parte) --- */
        #owls-section {
            width: 100%;
            height: 100vh; 
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 50px 0;
            box-sizing: border-box;
            overflow: hidden;
            position: relative;
        }

        /* === FIX 1: Corrected SVG scaling === */
        #owls-section svg {
            display: block;
            width: auto;   /* <-- CHANGED */
            height: 100%;  /* <-- CHANGED */
            overflow: visible;
            position: absolute; 
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); 
            z-index: 1; 
        }
        
        /* Efeitos de transição nos elementos da coruja (inalterado) */
        #owls-section use {
            transition: transform 0.5s ease-out, 
                        filter 0.4s ease, 
                        opacity 0.4s ease;
            cursor: pointer; 
        }

        /* Efeitos de hover nas corujas (inalterado) */
        #owls-section svg:hover use:not(:hover) { 
            opacity: 0.3; 
            transform: scale(0.95); 
        }
        #owls-section svg:hover use:hover { 
            transform: scale(1.05); 
            filter: drop-shadow(0 0 30px var(--solar-yellow)) drop-shadow(0 0 10px rgba(255, 239, 0, 0.5));
            animation: hoverSurge 0.5s ease-out forwards; 
        }

        /* Keyframe para animação de surge no hover (inalterado) */
        @keyframes hoverSurge {
            0% { transform: scale(1.05) rotate(0deg); }
            50% { transform: scale(1.06) rotate(0.5deg); } 
            100% { transform: scale(1.05) rotate(0deg); }
        }

        /* Propriedades gerais de animação para partes da coruja (inalterado) */
        .owl-unit-container {
            animation: unitPulseOwl 8s ease-in-out infinite, bobbing 4s ease-in-out infinite alternate;
            transform-origin: center; 
        }
        .face-group { 
            animation: headTurn 6s ease-in-out infinite alternate; 
            transform-origin: center; 
        }

        /* Atrasos de animação escalonados para corujas (inalterado) */
        #owl-1 .owl-unit-container, #owl-1 .face-group { animation-delay: -0s; }
        #owl-2 .owl-unit-container, #owl-2 .face-group { animation-delay: -1s; }
        #owl-3 .owl-unit-container, #owl-3 .face-group { animation-delay: -2s; }
        #owl-4 .owl-unit-container, #owl-4 .face-group { animation-delay: -3s; }
        #owl-5 .owl-unit-container, #owl-5 .face-group { animation-delay: -4s; }
        #owl-6 .owl-unit-container, #owl-6 .face-group { animation-delay: -5s; }


        .eye-glow-container { animation: eyePulse 2s ease-in-out infinite alternate; } 
        .inner-pulse { animation: innerPulseOpacityOwl 6s ease-out infinite alternate; }
        .pupil { animation: dilateOwl 4s ease-in-out infinite alternate; }
        .mote { 
            animation: driftOwl 10s ease-in-out infinite alternate; 
            fill: var(--light-text); /* Usa a cor de texto local */
            opacity: 0; 
        }
        
        /* Estilo para os contornos rotativos (inalterado) */
        .rotating-outline {
            /* fill removido daqui */
            stroke: var(--light-text); /* Usa a cor de texto local */
            stroke-width: 1.2;
            stroke-dasharray: 3 3;
        }

        /* Animações Keyframe para Corujas (inalterado) */
        @keyframes unitPulseOwl { 
            0% { opacity: 0; transform: scale(0.3); } 
            30% { opacity: 0.85; transform: scale(1); } 
            45% { opacity: 0.85; transform: scale(1); } 
            80% { opacity: 0; transform: scale(0.3); } 
            100% { opacity: 0; transform: scale(0.3); } 
        }
        @keyframes bobbing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); } 
        }
        @keyframes headTurn {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(1deg); } 
            75% { transform: rotate(-1deg); } 
        }
        @keyframes eyePulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; } 
        }

        .rotating-border { 
            animation: borderColorPulseOwl 8s ease-in-out infinite normal; 
        }
        @keyframes borderColorPulseOwl { 
            0%, 100% { stroke: var(--primary-glyph-color); } /* Pink */
            33.33% { stroke: var(--deep-purple); } 
            66.66% { stroke: var(--solar-yellow); } /* Yellow */
        }
        @keyframes innerPulseOpacityOwl { 0%, 100% { opacity: 0; } 50% { opacity: 0.6; } }
        @keyframes dilateOwl { 0%, 100% { r: 3; } 50% { r: 7; } }
        @keyframes driftOwl { 
            0% { transform: translate(0, 0) scale(0.5); opacity: 0.3; filter: blur(0px); } 
            50% { transform: translate(0, -50px) scale(1.2); opacity: 0.8; filter: blur(0px); } 
            100% { transform: translate(0, -100px) scale(1.8); opacity: 0; filter: blur(5px); } 
        }

        /* Estilos para a UI do Seletor de Padrões (inalterado) */
        #pattern-selector-ui {
            transform-origin: center;
        }
        .mini-owl-button {
            width: 50px; 
            height: 55px; 
            opacity: 0.4; 
            transition: opacity 0.3s ease, transform 0.3s ease, filter 0.3s ease;
            filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.2)); 
            pointer-events: auto; 
            cursor: pointer;
        }
        .mini-owl-button:hover {
            opacity: 0.7; 
            transform: scale(1.1); 
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.4)); 
        }
        .mini-owl-button.active {
            opacity: 1; 
            transform: scale(1.2); 
            filter: drop-shadow(0 0 15px var(--solar-yellow)) drop-shadow(0 0 5px var(--primary-glyph-color)); 
        }

        /* Media queries (inalterado) */
        @media (max-width: 768px) {
            #owls-section { padding: 30px 0; }
            #owls-section svg { max-width: 90%; }
            .mini-owl-button { width: 35px; height: 38.5px; } 
        }
    </style>
</head>

<body>

    <!-- Wrapper Principal (apenas para seção das corujas) -->
    <div id="main-content-wrapper">

        <!-- Seção das Corujas Neon -->
        <section id="owls-section">
            <!-- Contêiner SVG para corujas e animações -->
            <svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <!-- Filtros (inalterados) -->
                    <filter id="true-glow-pink" x="-150%" y="-150%" width="400%" height="400%" filterUnits="userSpaceOnUse"> <feDropShadow dx="0" dy="0" stdDeviation="8" flood-color="var(--primary-glyph-color)" flood-opacity="0.5" result="outerGlow"/> <feGaussianBlur in="SourceAlpha" stdDeviation="6" result="blurredAlpha"/> <feFlood flood-color="var(--primary-glyph-color)" flood-opacity="0.7" result="glowColor"/> <feComposite in="glowColor" in2="blurredAlpha" operator="in" result="softGlow"/> <feComposite in="softGlow" in2="SourceGraphic" operator="atop" result="innerGlow"/> <feMerge> <feMergeNode in="outerGlow"/> <feMergeNode in="SourceGraphic"/> <feMergeNode in="innerGlow"/> </feMerge> </filter>
                    <filter id="true-glow-deep-purple" x="-150%" y="-150%" width="400%" height="400%" filterUnits="userSpaceOnUse"> <feDropShadow dx="0" dy="0" stdDeviation="10" flood-color="var(--deep-purple)" flood-opacity="0.6" result="outerGlow"/> <feGaussianBlur in="SourceAlpha" stdDeviation="7" result="blurredAlpha"/> <feFlood flood-color="var(--deep-purple)" flood-opacity="0.8" result="glowColor"/> <feComposite in="glowColor" in2="blurredAlpha" operator="in" result="softGlow"/> <feComposite in="softGlow" in2="SourceGraphic" operator="atop" result="innerGlow"/> <feMerge> <feMergeNode in="outerGlow"/> <feMergeNode in="SourceGraphic"/> <feMergeNode in="innerGlow"/> </feMerge> </filter>
                    <filter id="true-glow-yellow" x="-150%" y="-150%" width="400%" height="400%" filterUnits="userSpaceOnUse"> <feDropShadow dx="0" dy="0" stdDeviation="9" flood-color="var(--solar-yellow)" flood-opacity="0.5" result="outerGlow"/> <feGaussianBlur in="SourceAlpha" stdDeviation="6" result="blurredAlpha"/> <feFlood flood-color="var(--solar-yellow)" flood-opacity="0.7" result="glowColor"/> <feComposite in="glowColor" in2="blurredAlpha" operator="in" result="softGlow"/> <feComposite in="softGlow" in2="SourceGraphic" operator="atop" result="innerGlow"/><feMerge> <feMergeNode in="outerGlow"/> <feMergeNode in="SourceGraphic"/> <feMergeNode in="innerGlow"/> </feMerge> </filter>
                    <filter id="eye-glow-subtle" x="-50%" y="-50%" width="200%" height="200%"> <feDropShadow dx="0" dy="0" stdDeviation="2.5" flood-color="var(--light-text)" flood-opacity="0.8"/> </filter>
                    <filter id="eye-glow-bright-deep-purple" x="-50%" y="-50%" width="200%" height="200%"> <feDropShadow dx="0" dy="0" stdDeviation="5" flood-color="var(--deep-purple)" flood-opacity="1"/> </filter>
                    <filter id="eye-glow-bright-yellow" x="-50%" y="-50%" width="200%" height="200%"> <feDropShadow dx="0" dy="0" stdDeviation="5" flood-color="var(--solar-yellow)" flood-opacity="1"/> </filter>
                    <filter id="mote-blur-filter" x="-50%" y="-50%" width="200%" height="200%"> <feGaussianBlur in="SourceGraphic" stdDeviation="2.5"/> </filter>
                    <radialGradient id="pulse-gradient"> <stop offset="0%" stop-color="var(--deep-purple)" /> <stop offset="70%" stop-color="rgba(44, 1, 90, 0)" /> </radialGradient>

                    <!-- Símbolo SVG para uma única coruja (MODIFICADO) -->
                    <symbol id="owl" viewBox="-70 -125 140 320">
                        <g class="owl-unit-container">
                            <circle class="rotating-border" cx="0" cy="-50" r="62" fill="none" stroke-width="1.5" stroke-dasharray="4 4"> <animateTransform attributeName="transform" type="rotate" from="0 0 -50" to="360 0 -50" dur="10s" repeatCount="indefinite"/> </circle>
                            <circle class="inner-pulse" cx="0" cy="-50" r="58" fill="url(#pulse-gradient)"> <animateTransform attributeName="transform" type="scale" values="0.7;1.2;0.7" keyTimes="0;0.5;1" dur="5s" repeatCount="indefinite" additive="sum"/> </circle>
                            <g>
                                <!-- Partes do corpo agora têm <animate> para o filtro, em vez de CSS -->
                                <ellipse class="owl-torso-part" cx="0" cy="130" rx="35" ry="55" fill="var(--dark-bg)"> 
                                    <animate attributeName="filter" values="url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/>
                                    <animate attributeName="rx" values="35;36;35;34;35" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                    <animate attributeName="ry" values="55;56;55;54;55" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                </ellipse>
                                <!-- CORREÇÃO: Adicionado fill="rgba(0,0,0,0.01)" aos rotating-outline -->
                                <ellipse class="rotating-outline" cx="0" cy="130" rx="35" ry="55" fill="rgba(0,0,0,0.01)" stroke-width="1.2" stroke-dasharray="3 3"> <animateTransform attributeName="transform" type="rotate" from="0 0 130" to="360 0 130" dur="8s" repeatCount="indefinite"/> <animate attributeName="filter" values="url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> </ellipse>
                                
                                <ellipse class="owl-wing-part" cx="-40" cy="55" rx="25" ry="85" fill="var(--dark-bg)"> 
                                    <animate attributeName="filter" values="url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/>
                                    <animate attributeName="rx" values="25;26;25;24;25" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                    <animate attributeName="ry" values="85;86;85;84;85" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                </ellipse>
                                <!-- CORREÇÃO: Adicionado fill="rgba(0,0,0,0.01)" aos rotating-outline -->
                                <ellipse class="rotating-outline" cx="-40" cy="55" rx="25" ry="85" fill="rgba(0,0,0,0.01)" stroke-width="1.2" stroke-dasharray="3 3"> <animateTransform attributeName="transform" type="rotate" from="0 -40 55" to="360 -40 55" dur="7s" repeatCount="indefinite"/> <animate attributeName="filter" values="url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> </ellipse>
                                
                                <ellipse class="owl-wing-part" cx="40" cy="55" rx="25" ry="85" fill="var(--dark-bg)">
                                    <animate attributeName="filter" values="url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/>
                                </ellipse>
                                <!-- CORREÇÃO: Adicionado fill="rgba(0,0,0,0.01)" aos rotating-outline -->
                                <ellipse class="rotating-outline" cx="40" cy="55" rx="25" ry="85" fill="rgba(0,0,0,0.01)" stroke-width="1.2" stroke-dasharray="3 3"> <animateTransform attributeName="transform" type="rotate" from="0 40 55" to="360 40 55" dur="7s" repeatCount="indefinite"/> <animate attributeName="filter" values="url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> </ellipse>
                                
                                <ellipse class="owl-torso-part" cx="0" cy="55" rx="48" ry="85" fill="var(--dark-bg)"> 
                                    <animate attributeName="filter" values="url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/>
                                    <animate attributeName="rx" values="48;49;48;47;48" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                    <animate attributeName="ry" values="85;86;85;84;85" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                </ellipse>
                                <!-- CORREÇÃO: Adicionado fill="rgba(0,0,0,0.01)" aos rotating-outline -->
                                <ellipse class="rotating-outline" cx="0" cy="55" rx="48" ry="85" fill="rgba(0,0,0,0.01)" stroke-width="1.2" stroke-dasharray="3 3"> <animateTransform attributeName="transform" type="rotate" from="0 0 55" to="360 0 55" dur="9s" repeatCount="indefinite"/> <animate attributeName="filter" values="url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> </ellipse>
                                
                                <circle class="owl-head-part" cx="0" cy="-50" r="58" fill="var(--dark-bg)"> 
                                    <animate attributeName="filter" values="url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/>
                                    <animate attributeName="r" values="58;59;58;57;58" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                </circle>
                                
                                <ellipse class="owl-head-part" cx="-26" cy="-50" rx="31" ry="50" fill="var(--dark-bg)"> 
                                    <animate attributeName="filter" values="url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/>
                                    <animate attributeName="rx" values="31;32;31;30;31" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                    <animate attributeName="ry" values="50;51;50;49;50" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                </ellipse>
                                <!-- CORREÇÃO: Adicionado fill="rgba(0,0,0,0.01)" aos rotating-outline -->
                                <ellipse class="rotating-outline" cx="-26" cy="-50" rx="31" ry="50" fill="rgba(0,0,0,0.01)" stroke-width="1.2" stroke-dasharray="3 3"> <animateTransform attributeName="transform" type="rotate" from="0 -26 -50" to="360 -26 -50" dur="6s" repeatCount="indefinite"/> <animate attributeName="filter" values="url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> </ellipse>
                                
                                <ellipse class="owl-head-part" cx="26" cy="-50" rx="31" ry="50" fill="var(--dark-bg)"> 
                                    <animate attributeName="filter" values="url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/>
                                    <animate attributeName="rx" values="31;32;31;30;31" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                    <animate attributeName="ry" values="50;51;50;49;50" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> 
                                </ellipse>
                                <!-- CORREÇÃO: Adicionado fill="rgba(0,0,0,0.01)" aos rotating-outline -->
                                <ellipse class="rotating-outline" cx="26" cy="-50" rx="31" ry="50" fill="rgba(0,0,0,0.01)" stroke-width="1.2" stroke-dasharray="3 3"> <animateTransform attributeName="transform" type="rotate" from="0 26 -50" to="360 26 -50" dur="6s" repeatCount="indefinite"/> <animate attributeName="filter" values="url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> </ellipse>
                            </g>
                        </g>
                        <g class="face-group">
                            <g class="eye-glow-container">
                                <circle id="left-eye-main-circle" cx="-23" cy="-50" r="15" fill="var(--dark-bg)" > <animate attributeName="filter" values="url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> <animate attributeName="r" values="15;16;15;14;15" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> </circle>
                                <!-- CORREÇÃO: Adicionado fill="rgba(0,0,0,0.01)" aos rotating-outline -->
                                <circle class="rotating-outline" cx="-23" cy="-50" r="15" fill="rgba(0,0,0,0.01)" stroke-width="0.8" stroke-dasharray="2 2"> <animateTransform attributeName="transform" type="rotate" from="0 -23 -50" to="360 -23 -50" dur="4s" repeatCount="indefinite"/> <animate attributeName="filter" values="url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> </circle>
                                <circle id="right-eye-main-circle" cx="23" cy="-50" r="15" fill="var(--dark-bg)" > <animate attributeName="filter" values="url(#true-glow-yellow);url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> <animate attributeName="r" values="15;16;15;14;15" keyTimes="0;0.25;0.5;0.75;1" dur="8s" repeatCount="indefinite"/> </circle>
                                <!-- CORREÇÃO: Adicionado fill="rgba(0,0,0,0.01)" aos rotating-outline -->
                                <circle class="rotating-outline" cx="23" cy="-50" r="15" fill="rgba(0,0,0,0.01)" stroke-width="0.8" stroke-dasharray="2 2"> <animateTransform attributeName="transform" type="rotate" from="0 23 -50" to="360 23 -50" dur="4s" repeatCount="indefinite"/> <animate attributeName="filter" values="url(#true-glow-pink);url(#true-glow-deep-purple);url(#true-glow-yellow);url(#true-glow-pink)" keyTimes="0;0.3333;0.6666;1" dur="8s" repeatCount="indefinite"/> </circle>
                            </g>
                            <circle class="pupil" cx="-23" cy="-50" r="7" fill="var(--dark-bg)" />
                            <circle class="pupil" cx="23" cy="-50" r="7" fill="var(--dark-bg)" />
                            <polygon points="-5, -46 5, -46 0, -23" fill="var(--light-text)" />
                        </g>
                    </symbol>
                </defs>

                <!-- Grupo para camadas de nebulosa (inalterado) -->
                <g id="nebula-layers">
                    <path d="M 0 0 C 150 50 100 150 200 200 C 300 250 350 150 450 100 C 500 50 600 0 800 50 L 800 600 L 0 600 Z" class="nebula-shape" fill="rgba(255, 30, 142, 0.03)" filter="url(#true-glow-pink)"> <animateTransform attributeName="transform" type="translate" from="0 0" to="50 30" dur="40s" repeatCount="indefinite" additive="sum" calcMode="linear"/> <animate attributeName="opacity" values="0.05;0.1;0.05" keyTimes="0;0.5;1" dur="25s" repeatCount="indefinite"/> </path>
                    <path d="M 800 600 C 650 550 700 450 600 400 C 500 350 450 450 350 500 C 300 550 200 600 0 550 L 0 0 L 800 0 Z" class="nebula-shape" fill="rgba(44, 1, 90, 0.03)" filter="url(#true-glow-deep-purple)"> <animateTransform attributeName="transform" type="translate" from="0 0" to="-40 -20" dur="45s" repeatCount="indefinite" additive="sum" calcMode="linear"/> <animateTransform attributeName="transform" type="rotate" from="0 400 300" to="360 400 300" dur="60s" repeatCount="indefinite" additive="sum" /> <animate attributeName="opacity" values="0.08;0.03;0.08" keyTimes="0;0.5;1" dur="20s" repeatCount="indefinite"/> </path>
                </g>
                
                <!-- Grupo para blobs de luz dinâmicos (inalterado) -->
                <g id="owl-light-blobs">
                    <circle id="light-blob-1" cx="0" cy="0" r="100" fill="var(--primary-glyph-color)" fill-opacity="0.08" filter="url(#true-glow-pink)"> <animate attributeName="r" values="100;120;100" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> <animate attributeName="fill-opacity" values="0.08;0.12;0.08" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> </circle>
                    <circle id="light-blob-2" cx="0" cy="0" r="100" fill="var(--deep-purple)" fill-opacity="0.08" filter="url(#true-glow-deep-purple)"> <animate attributeName="r" values="100;120;100" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> <animate attributeName="fill-opacity" values="0.08;0.12;0.08" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> </circle>
                    <circle id="light-blob-3" cx="0" cy="0" r="100" fill="var(--solar-yellow)" fill-opacity="0.08" filter="url(#true-glow-yellow)"> <animate attributeName="r" values="100;120;100" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> <animate attributeName="fill-opacity" values="0.08;0.12;0.08" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> </circle>
                     <circle id="light-blob-4" cx="0" cy="0" r="100" fill="var(--primary-glyph-color)" fill-opacity="0.08" filter="url(#true-glow-pink)"> <animate attributeName="r" values="100;120;100" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> <animate attributeName="fill-opacity" values="0.08;0.12;0.08" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> </circle>
                    <circle id="light-blob-5" cx="0" cy="0" r="100" fill="var(--deep-purple)" fill-opacity="0.08" filter="url(#true-glow-deep-purple)"> <animate attributeName="r" values="100;120;100" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> <animate attributeName="fill-opacity" values="0.08;0.12;0.08" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> </circle>
                    <circle id="light-blob-6" cx="0" cy="0" r="100" fill="var(--solar-yellow)" fill-opacity="0.08" filter="url(#true-glow-yellow)"> <animate attributeName="r" values="100;120;100" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> <animate attributeName="fill-opacity" values="0.08;0.12;0.08" keyTimes="0;0.5;1" dur="4s" repeatCount="indefinite" /> </circle>
                </g>

                <!-- Grupo para motes de energia (inalterado) -->
                <g id="energy-motes" filter="url(#eye-glow-subtle)"></g>
                
                <!-- Instâncias do símbolo da coruja (inalterado) -->
                <use id="owl-1" href="#owl" x="100" y="100" width="150" height="165" />
                <use id="owl-2" href="#owl" x="325" y="100" width="150" height="165" />
                <use id="owl-3" href="#owl" x="550" y="100" width="150" height="165" />
                <use id="owl-4" href="#owl" x="100" y="300" width="150" height="165" />
                <use id="owl-5" href="#owl" x="325" y="300" width="150" height="165" />
                <use id="owl-6" href="#owl" x="550" y="300" width="150" height="165" />

            </svg>
        </section>

    </div> <!-- Fim main-content-wrapper -->

    <script>
        // --- JAVASCRIPT (Mostly Unchanged) ---
        document.addEventListener('DOMContentLoaded', () => {
            const svgNS = 'http://www.w3.org/2000/svg'; 
            const mainOwlSvgElement = document.querySelector('#owls-section svg'); 
            const motesContainer = document.getElementById('energy-motes');
            const particleCount = 2000;

            function createPolygonPoints(cx, cy, radius, sides) { const points = []; for (let i = 0; i < sides; i++) { const angle = (Math.PI * 2 * i / sides) - (Math.PI / 2); points.push(`${cx + radius * Math.cos(angle)},${cy + radius * Math.sin(angle)}`); } return points.join(' '); }
            function createStarPoints(cx, cy, outerRadius, innerRadius, numTips) { const points = []; for (let i = 0; i < numTips * 2; i++) { const radius = (i % 2 === 0) ? outerRadius : innerRadius; const angle = (Math.PI * i / numTips) - (Math.PI / 2); points.push(`${cx + radius * Math.cos(angle)},${cy + radius * Math.sin(angle)}`); } return points.join(' '); }

            for (let i = 0; i < particleCount; i++) {
                const x = Math.random() * 800; 
                const y = Math.random() * 600; 
                const delay = Math.random() * -10; 
                const duration = Math.random() * 8 + 6; 
                const moteType = Math.random();
                let mote;
                if (moteType < 0.4) { mote = document.createElementNS(svgNS, 'circle'); mote.setAttribute('r', Math.random() * 2 + 1); mote.setAttribute('cx', x); mote.setAttribute('cy', y); } else if (moteType < 0.8) { mote = document.createElementNS(svgNS, 'polygon'); const sides = Math.floor(Math.random() * 4) + 3; const radius = Math.random() * 2 + 1; mote.setAttribute('points', createPolygonPoints(x, y, radius, sides)); } else { mote = document.createElementNS(svgNS, 'polygon'); const outerRadius = Math.random() * 2 + 1; const innerRadius = outerRadius * (0.3 + Math.random() * 0.3); const numTips = 5; mote.setAttribute('points', createStarPoints(x, y, outerRadius, innerRadius, numTips)); }
                mote.setAttribute('class', 'mote'); mote.style.animationDelay = `${delay}s`; mote.style.animationDuration = `${duration}s`; motesContainer.appendChild(mote);
            }

            function generateOwlEmittedParticles(owlX, owlY, owlWidth, owlHeight) {
                const particlesPerBurst = 8; 
                const spreadRadius = 25; 
                const owlCenterX = owlX + owlWidth / 2;
                const owlCenterY = owlY + owlHeight / 2;
                for (let k = 0; k < particlesPerBurst; k++) {
                    const startX = owlCenterX + (Math.random() - 0.5) * spreadRadius;
                    const startY = owlCenterY + (Math.random() - 0.5) * spreadRadius;
                    const delay = Math.random() * -3; 
                    const duration = Math.random() * 4 + 4; 
                    const moteType = Math.random();
                    let mote;
                    if (moteType < 0.4) { mote = document.createElementNS(svgNS, 'circle'); mote.setAttribute('r', Math.random() * 1.5 + 0.5); mote.setAttribute('cx', startX); mote.setAttribute('cy', startY); } else if (moteType < 0.8) { mote = document.createElementNS(svgNS, 'polygon'); const sides = Math.floor(Math.random() * 4) + 3; const radius = Math.random() * 1.5 + 0.5; mote.setAttribute('points', createPolygonPoints(startX, startY, radius, sides)); } else { mote = document.createElementNS(svgNS, 'polygon'); const outerRadius = Math.random() * 1.5 + 0.5; const innerRadius = outerRadius * (0.3 + Math.random() * 0.3); const numTips = 5; mote.setAttribute('points', createStarPoints(startX, startY, outerRadius, innerRadius, numTips)); }
                    mote.setAttribute('class', 'mote'); mote.style.animationDelay = `${delay}s`; mote.style.animationDuration = `${duration}s`; motesContainer.appendChild(mote);
                }
            }

            const baseOwlsData = [ { id: 'owl-1', element: document.getElementById('owl-1'), initialSvgX: 100, initialSvgY: 100 }, { id: 'owl-2', element: document.getElementById('owl-2'), initialSvgX: 325, initialSvgY: 100 }, { id: 'owl-3', element: document.getElementById('owl-3'), initialSvgX: 550, initialSvgY: 100 }, { id: 'owl-4', element: document.getElementById('owl-4'), initialSvgX: 100, initialSvgY: 300 }, { id: 'owl-5', element: document.getElementById('owl-5'), initialSvgX: 325, initialSvgY: 300 }, { id: 'owl-6', element: document.getElementById('owl-6'), initialSvgX: 550, initialSvgY: 300 } ];
            const lightBlob1 = document.getElementById('light-blob-1'); const lightBlob2 = document.getElementById('light-blob-2'); const lightBlob3 = document.getElementById('light-blob-3'); const lightBlob4 = document.getElementById('light-blob-4'); const lightBlob5 = document.getElementById('light-blob-5'); const lightBlob6 = document.getElementById('light-blob-6');
            const owlLightBlobMap = { 'owl-1': lightBlob1, 'owl-2': lightBlob2, 'owl-3': lightBlob3, 'owl-4': lightBlob4, 'owl-5': lightBlob5, 'owl-6': lightBlob6 };
            const allPupils = [];
            baseOwlsData.forEach(owlData => { const owlElement = owlData.element; const leftPupil = owlElement.querySelector('.pupil[cx="-23"]'); const rightPupil = owlElement.querySelector('.pupil[cx="23"]'); const leftEyeCircle = owlElement.querySelector('#left-eye-main-circle'); const rightEyeCircle = owlElement.querySelector('#right-eye-main-circle'); if (leftPupil && leftEyeCircle) { allPupils.push({ pupilElement: leftPupil, eyeCircleElement: leftEyeCircle, parentOwlElement: owlElement, relativeCx: parseFloat(leftPupil.getAttribute('cx')), relativeCy: parseFloat(leftPupil.getAttribute('cy')) }); } if (rightPupil && rightEyeCircle) { allPupils.push({ pupilElement: rightPupil, eyeCircleElement: rightEyeCircle, parentOwlElement: owlElement, relativeCx: parseFloat(rightPupil.getAttribute('cx')), relativeCy: parseFloat(rightPupil.getAttribute('cy')) }); } });

            let currentDanceIndex = 0;
            
            // === FIX 2: Corrected dancePatterns array ===
            const dancePatterns = [
              // Pattern 0 (Circle) - Clamped
              [ { x: 400, y: 150 }, { x: 550, y: 250 }, { x: 550, y: 400 }, { x: 400, y: 515 }, { x: 250, y: 400 }, { x: 250, y: 250 } ], 
              // Pattern 1 (Grid) - Already safe
              [ { x: 150, y: 150 }, { x: 400, y: 150 }, { x: 650, y: 150 }, { x: 150, y: 450 }, { x: 400, y: 450 }, { x: 650, y: 450 } ], 
              // Pattern 2 (Vertical Line) - Clamped
              [ { x: 400, y: 85 }, { x: 400, y: 150 }, { x: 400, y: 250 }, { x: 400, y: 350 }, { x: 400, y: 450 }, { x: 400, y: 515 } ], 
              // Pattern 3 (Cross) - Clamped
              [ { x: 400, y: 85 }, { x: 400, y: 300 }, { x: 400, y: 515 }, { x: 150, y: 300 }, { x: 650, y: 300 }, { x: 75, y: 85 } ], 
              // Pattern 4 (Star) - Clamped
              [ { x: 400, y: 85 }, { x: 650, y: 300 }, { x: 400, y: 515 }, { x: 150, y: 300 }, { x: 300, y: 200 }, { x: 500, y: 400 } ], 
              // Pattern 5 (Inner Cluster) - Already safe
              [ { x: 400, y: 300 }, { x: 400, y: 200 }, { x: 500, y: 300 }, { x: 400, y: 400 }, { x: 300, y: 300 }, { x: 450, y: 250 } ], 
              // Pattern 6 (Diagonal) - Clamped
              [ { x: 100, y: 100 }, { x: 200, y: 200 }, { x: 300, y: 300 }, { x: 400, y: 400 }, { x: 500, y: 500 }, { x: 600, y: 515 } ], 
              // Pattern 7 (Offset Cluster) - Already safe
              [ { x: 200, y: 250 }, { x: 250, y: 350 }, { x: 350, y: 200 }, { x: 450, y: 300 }, { x: 500, y: 400 }, { x: 600, y: 250 } ], 
              // Pattern 8 (Box) - Already safe
              [ { x: 400, y: 300 }, { x: 400, y: 250 }, { x: 450, y: 250 }, { x: 450, y: 350 }, { x: 350, y: 350 }, { x: 350, y: 200 } ], 
              // Pattern 9 (Random) - CORRECTED RANGES
              [ 
                { x: Math.random() * 650 + 75, y: Math.random() * 430 + 85 }, 
                { x: Math.random() * 650 + 75, y: Math.random() * 430 + 85 }, 
                { x: Math.random() * 650 + 75, y: Math.random() * 430 + 85 }, 
                { x: Math.random() * 650 + 75, y: Math.random() * 430 + 85 }, 
                { x: Math.random() * 650 + 75, y: Math.random() * 430 + 85 }, 
                { x: Math.random() * 650 + 75, y: Math.random() * 430 + 85 } 
              ] 
            ];

            let animationStartTime = null;
            let layoutChangeTimeout; 
            const cycleInterval = 4000; 
            const animationDuration = 1500; 

            let mouseX_svg = 0; let mouseY_svg = 0;
            window.addEventListener('mousemove', (e) => { const pt = mainOwlSvgElement.createSVGPoint(); pt.x = e.clientX; pt.y = e.clientY; const svgP = pt.matrixTransform(mainOwlSvgElement.getScreenCTM().inverse()); mouseX_svg = svgP.x; mouseY_svg = svgP.y; });

            function shuffleArray(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } return array; }
            const hasEmittedParticles = new Map();

            function startNewTriangleLayout(patternIndexOverride) {
                animationStartTime = null; 
                hasEmittedParticles.clear(); 
                if (layoutChangeTimeout) { clearTimeout(layoutChangeTimeout); }
                let nextPatternIndex;
                if (typeof patternIndexOverride === 'number') { nextPatternIndex = patternIndexOverride; } else { nextPatternIndex = (currentDanceIndex + 1) % dancePatterns.length; }
                currentDanceIndex = nextPatternIndex; 
                const currentPatternTargetPositions = dancePatterns[currentDanceIndex];
                const shuffledTargetPositions = shuffleArray([...currentPatternTargetPositions]);
                baseOwlsData.forEach((owlData, index) => { owlData.targetX = shuffledTargetPositions[index].x; owlData.targetY = shuffledTargetPositions[index].y; });
                requestAnimationFrame(animateOwlTransition);
            }

            function animateOwlTransition(currentTime) {
                if (animationStartTime === null) { animationStartTime = currentTime; }
                let progress = (currentTime - animationStartTime) / animationDuration;
                progress = Math.min(1, Math.max(0, progress)); 
                const easedProgress = 0.5 - Math.cos(progress * Math.PI) / 2; 
                baseOwlsData.forEach(owlData => { const owlElement = owlData.element; const startX = owlData.initialSvgX; const startY = owlData.initialSvgY; const targetX = owlData.targetX; const targetY = owlData.targetY; const currentX = startX + (targetX - startX) * easedProgress; const currentY = startY + (targetY - startY) * easedProgress; owlElement.setAttribute('x', currentX); owlElement.setAttribute('y', currentY); owlElement.style.transform = ''; const lightBlob = owlLightBlobMap[owlData.id]; if (lightBlob) { const owlDisplayWidth = parseFloat(owlElement.getAttribute('width')); const owlDisplayHeight = parseFloat(owlElement.getAttribute('height')); lightBlob.setAttribute('cx', currentX + owlDisplayWidth / 2); lightBlob.setAttribute('cy', currentY + owlDisplayHeight / 2); } if (progress === 1 && (!hasEmittedParticles.has(owlData.id) || !hasEmittedParticles.get(owlData.id))) { if (startX !== targetX || startY !== targetY) { generateOwlEmittedParticles(owlData.targetX, owlData.targetY, parseFloat(owlElement.getAttribute('width')), parseFloat(owlElement.getAttribute('height'))); hasEmittedParticles.set(owlData.id, true); } } });
                if (progress < 1) { requestAnimationFrame(animateOwlTransition); } else { baseOwlsData.forEach(owlData => { owlData.initialSvgX = owlData.targetX; owlData.initialSvgY = owlData.targetY; }); layoutChangeTimeout = setTimeout(() => startNewTriangleLayout(), cycleInterval); }
            }

            function animateGaze() {
                allPupils.forEach(eyeData => { const { pupilElement, eyeCircleElement, parentOwlElement, relativeCx, relativeCy } = eyeData; const owlCurrentX = parseFloat(parentOwlElement.getAttribute('x')); const owlCurrentY = parseFloat(parentOwlElement.getAttribute('y')); const eyeAbsoluteCenterX = owlCurrentX + (relativeCx); const eyeAbsoluteCenterY = owlCurrentY + (relativeCy); const dx = mouseX_svg - eyeAbsoluteCenterX; const dy = mouseY_svg - eyeAbsoluteCenterY; const distance = Math.sqrt(dx * dx + dy * dy); let offsetX = 0; let offsetY = 0; const eyeRadius = parseFloat(eyeCircleElement.getAttribute('r')); const pupilRadius = parseFloat(pupilElement.getAttribute('r')); const effectiveMaxOffset = eyeRadius - pupilRadius - 1; if (distance > 0) { offsetX = (dx / distance) * Math.min(distance, effectiveMaxOffset); offsetY = (dy / distance) * Math.min(distance, effectiveMaxOffset); } pupilElement.setAttribute('cx', relativeCx + offsetX); pupilElement.setAttribute('cy', relativeCy + offsetY); });
                requestAnimationFrame(animateGaze);
            }

            baseOwlsData.forEach(owlData => { owlData.element.addEventListener('click', (e) => { const owlX = parseFloat(e.currentTarget.getAttribute('x')); const owlY = parseFloat(e.currentTarget.getAttribute('y')); const owlWidth = parseFloat(e.currentTarget.getAttribute('width')); const owlHeight = parseFloat(e.currentTarget.getAttribute('height')); generateOwlEmittedParticles(owlX, owlY, owlWidth, owlHeight); }); });

            startNewTriangleLayout(0); 
            requestAnimationFrame(animateGaze);
        });
    </script>

</body>
</html>
