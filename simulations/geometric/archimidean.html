<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archimedean Spiral</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
          --dark-bg: #0D0D0D;
          --light-text: #BBBBBB;
          --primary-glyph-color: #FF1E8E;
          --electric-cyan: #00FFF7;
        }
        body {
            font-family: 'Orbitron', sans-serif;
            background-color: var(--dark-bg);
            color: var(--light-text);
            margin: 0;
            overflow: hidden; /* Hide scrollbars */
        }
        .spiral-window {
            height: 100vh;
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .spiral-svg {
            width: 100vw;
            height: 100vh;
            animation: spin 30s linear infinite;
        }
        .spiral-path {
            stroke: url(#gradient);
            fill: none;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        #mode-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
            transition: background-color 0.3s ease;
        }
        #mode-toggle:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        #mode-toggle.active {
            background-color: rgba(255, 30, 142, 0.4);
        }
    </style>
</head>
<body class="antialiased">

    <!-- SVG definition for the gradient -->
    <svg width="0" height="0" style="position:absolute;">
        <defs>
            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:var(--electric-cyan); stop-opacity:1" />
                <stop offset="100%" style="stop-color:var(--primary-glyph-color); stop-opacity:1" />
            </linearGradient>
        </defs>
    </svg>

    <main>
        <!-- Archimedean Spiral Window -->
        <div class="spiral-window">
             <svg class="spiral-svg" viewBox="-350 -350 700 700">
                <path class="spiral-path" id="archimedean-path"></path>
             </svg>
        </div>
        <button id="mode-toggle"></button>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const archimedeanSpiral = {
                id: 'archimedean-path',
                generator: (progress) => {
                    let path = 'M 0,0';
                    const initialB = 0.1;
                    const finalB = 60.0;
                    const currentB = initialB + (finalB - initialB) * progress;
                    const initialIterations = 1;
                    const finalIterations = 10000;
                    const currentIterations = initialIterations + (finalIterations - initialIterations) * progress;
                    for (let i = 0; i < currentIterations; i++) {
                        const angle = 0.1 * i;
                        const x = (currentB * angle) * Math.cos(angle);
                        const y = (currentB * angle) * Math.sin(angle);
                        path += ` L ${x},${y}`;
                    }
                    return path;
                }
            };

            function easeInOutCubic(t) {
                return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
            }

            function triggerSpiralAnimation(config) {
                const pathEl = document.getElementById(config.id);
                if (!pathEl) return;
                const svgElement = pathEl.closest('.spiral-svg');
                if (!svgElement) return;
                const modeToggleButton = document.getElementById('mode-toggle');

                let startTime = null;
                const duration = 15000;
                const initialViewBoxSize = 700;
                const finalViewBoxSize = 20000;
                const initialStrokeWidth = 1;
                const finalStrokeWidth = 8;

                let keepSpinning = false;
                let direction = 1; // 1 for growing, -1 for shrinking
                let pausedAtMax = false;
                let pauseTimeoutId = null;

                modeToggleButton.addEventListener('click', () => {
                    keepSpinning = !keepSpinning;
                    modeToggleButton.classList.toggle('active', keepSpinning);

                    clearTimeout(pauseTimeoutId);
                    pauseTimeoutId = null;

                    if (!keepSpinning && pausedAtMax) {
                        pausedAtMax = false;
                        direction = -1;
                        startTime = null;
                    }
                });

                function animate(currentTime) {
                    if (pausedAtMax && keepSpinning) {
                        requestAnimationFrame(animate);
                        return; // Stay at max size, CSS handles spinning
                    }

                    if (startTime === null) startTime = currentTime;

                    let elapsedTime = currentTime - startTime;
                    let rawProgress = Math.min(elapsedTime / duration, 1);

                    const easedProgress = (direction === 1) 
                        ? easeInOutCubic(rawProgress) 
                        : easeInOutCubic(1 - rawProgress);

                    const newPathData = config.generator(easedProgress);
                    pathEl.setAttribute('d', newPathData);

                    const currentViewBoxSize = initialViewBoxSize + (finalViewBoxSize - initialViewBoxSize) * easedProgress;
                    const currentMin = -currentViewBoxSize / 2;
                    svgElement.setAttribute('viewBox', `${currentMin} ${currentMin} ${currentViewBoxSize} ${currentViewBoxSize}`);

                    const currentStrokeWidth = initialStrokeWidth + (finalStrokeWidth - initialStrokeWidth) * easedProgress;
                    pathEl.style.strokeWidth = `${currentStrokeWidth}px`;

                    if (rawProgress >= 1) {
                        if (direction === 1) { // Finished growing
                            if (keepSpinning) {
                                pausedAtMax = true;
                            } else {
                                if (!pauseTimeoutId) {
                                    pauseTimeoutId = setTimeout(() => {
                                        direction = -1;
                                        startTime = null;
                                        pauseTimeoutId = null;
                                    }, 5000); // 5-second pause
                                }
                            }
                        } else { // Finished shrinking
                            direction = 1;
                            startTime = null;
                            pausedAtMax = false;
                        }
                    }
                    requestAnimationFrame(animate);
                }
                requestAnimationFrame(animate);
            }

            triggerSpiralAnimation(archimedeanSpiral);
        });
    </script>
</body>
</html>

